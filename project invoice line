TRUNCATE TABLE [dbo].[_invoice_ft_projinvoiceline]
INSERT INTO[dbo].[_invoice_ft_projinvoiceline]

SELECT 
  T1.[CURRENCYID] AS "CURRENCYCODE",
  T1.[DATAAREAID1] AS "DATAAREAID",
  T1.[INVENTTRANSID], 
  T1.[INVOICEDATE], 
  T1.[ITEMID] AS "ITEMNUMBER",
  T1.[LINEAMOUNT],
  T1.[LINEDISC] AS "LINETOTALDISCOUNTAMOUNT", 
  T1.[PROJID] AS "Project ID",
  T1.[PROJINVOICEID] AS "INVOICENUMBER",
  T1.[PROJINVOICEITEMRECID] AS "RECID",
  T1.[QTY] AS "INVOICEDQUANTITY",
  T1.[SALESID], 
  T1.[SALESUNIT] AS "SALESUNITSYMBOL", 
  T1.[TAXAMOUNT] AS "LINETOTALTAXAMOUNT",
  T1.[TXT] AS "PRODUCTDESCRIPTION",
  T1.[ITEMBATCHNUMBER], 
  T1.[PRODUCTCOLORID], 
  T1.[PRODUCTSIZEID], 
  T1.[PRODUCTCONFIGURATIONID], 
  T1.[SHIPPINGSITEID] AS "INVENTORYSITEID",
  T1.[SHIPPINGWAREHOUSEID] AS "INVENTORYWAREHOUSEID",
  T1.[PRODUCTSTYLEID], 
  T1.[SYNCSTARTDATETIME], 
  T2.[INVOICEACCOUNT] AS "INVOICECUSTOMERACCOUNTNUMBER",
  T2.[INVOICEAMOUNT] AS "TOTALINVOICEAMOUNT",
  T2.[LEDGERVOUCHER], 
  'Project Invoicing Table' AS "Table", 
  'Product Helper' = Substring
                        (
                          T1.[ITEMID]
                          + IIF(T1.[PRODUCTCOLORID] = NULL, '',T1.[PRODUCTCOLORID])
                          + IIF(T1.[PRODUCTSTYLEID] = NULL, '',T1.[PRODUCTSTYLEID])
                          + IIF(T1.[PRODUCTSIZEID] = NULL, '',T1.[PRODUCTSIZEID])
                          + IIF(T1.[PRODUCTCONFIGURATIONID] = NULL,'',T1.[PRODUCTCONFIGURATIONID]),
                          1,
                          200
                        ), 
  T1.[SALESID] + ';' + T1.[INVENTTRANSID] AS "SO Line Helper", 
  T1.[DATAAREAID] + T1.[DEFAULTDIMENSIONDISPLAYVALUE] AS "FinDim Code",
  T1.[LINEAMOUNT] / T1.[QTY] AS "SALESPRICE",
  T3.[COMMISSIONSALESREPRESENTATIVEGROUPID]
  FROM [dbo].[IDSProjInvoiceItemStaging] T1
  LEFT JOIN [dbo].[IDSProjInvoiceJourStaging] T2
  on T1.[PROJINVOICEID] = T2.[PROJINVOICEID]
  LEFT JOIN [dbo].[_salesorder_ft_soline] T3
  on "SO Line Helper" = T3.[SO Line Helper]
