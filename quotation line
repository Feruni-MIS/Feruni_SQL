-- TRUNCATE TABLE [dbo].[_quotation_ft_quotationline]
-- INSERT INTO [dbo].[_quotation_ft_quotationline]

SELECT
    T1.[SALESQUOTATIONNUMBER],
	T1.[INVENTORYLOTID],
	T1.[SALESQUOTATIONSTATUS],
	T1.[ITEMNUMBER],
	T1.[LINEAMOUNT],
	T1.[LINEDISCOUNTAMOUNT],
	T1.[LINEDISCOUNTPERCENTAGE],
	T1.[MULTILINEDISCOUNTAMOUNT],
	T1.[MULTILINEDISCOUNTPERCENTAGE],
	T1.[LINEDESCRIPTION],
	T1.[SALESPRICEQUANTITY],
	T1.[REQUESTEDRECEIPTDATE],
	T1.[SALESPRICE],
	T1.[REQUESTEDSALESQUANTITY],
	T1.[REQUESTEDSHIPPINGDATE],
	T1.[SALESPRODUCTCATEGORYNAME],
	T1.[MAINACCOUNTIDDISPLAYVALUE],
	T1.[DEFAULTLEDGERDIMENSIONDISPLAYVALUE],
	T1.[PRODUCTSTYLEID],
	T1.[PRODUCTSIZEID],
	T1.[PRODUCTCOLORID],
	T1.[ITEMBATCHNUMBER],
	T1.[PRODUCTCONFIGURATIONID],
	T1.[LINECREATIONSEQUENCENUMBER],
	T1.[INVOICECUSTOMERACCOUNTNUMBER],
	T1.[PROSPECTID],
	T1.[DATAAREAID],
    'Product Helper' = Substring 
                          (
                            T1.[ITEMNUMBER]
                            + IIF( T1.[PRODUCTCOLORID] = NULL, '',T1.[PRODUCTCOLORID] )
                            + IIF( T1.[PRODUCTSTYLEID] = NULL, '',T1.[PRODUCTSTYLEID] )
                            + IIF( T1.[PRODUCTSIZEID] = NULL, '', T1.[PRODUCTSIZEID] )
                            + IIF( T1.[PRODUCTCONFIGURATIONID] = NULL,'',T1.[PRODUCTCONFIGURATIONID] ),
                            1,
                            200
                            ),
    CONCAT(T1.[DATAAREAID], T1.[DEFAULTLEDGERDIMENSIONDISPLAYVALUE]) AS "FinDim Code",
    T2.[RECEIPTDATEREQUESTED], 
    T2.[QUOTATIONRESPONSIBLEPERSONNELNUMBER], 
    T2.[CREATEDDATETIME1]
    FROM [dbo].[SalesQuotationLineV2Staging] T1
    LEFT JOIN [dbo].[_quotation_dm_quotationheader] T2
    on T1.[SALESQUOTATIONNUMBER] = T2.[SALESQUOTATIONNUMBER]
