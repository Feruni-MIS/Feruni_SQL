TRUNCATE TABLE [dbo].[_invoice_dm_invoiceheader]
INSERT INTO[dbo].[_invoice_dm_invoiceheader]

SELECT
	[INVOICEHEADERTAXAMOUNT] 
	, [INVOICEADDRESSCOUNTRYREGIONISOCODE] 
	, [TOTALDISCOUNTAMOUNT] 
	, [DEFINITIONGROUP] 
	, [EXECUTIONID] 
	, [ISSELECTED] 
	, [TRANSFERSTATUS]
	, [INVOICENUMBER]
	, [INVOICEDATE] 
	, [CONTACTPERSONID] 
	, [CUSTOMERSORDERREFERENCE]
	, [DELIVERYMODECODE] 
	, [DELIVERYTERMSCODE]
	, [PAYMENTTERMSNAME]
	, [TOTALINVOICEAMOUNT]
	, [CURRENCYCODE]
	, [TOTALTAXAMOUNT]
	, [TOTALCHARGEAMOUNT]
	, [TOTALDISCOUNTCUSTOMERGROUPCODE]
	, [INVOICECUSTOMERACCOUNTNUMBER]
	, [SALESORDERNUMBER]
	, [INVOICEADDRESSSTATE]
	, [INVOICEADDRESSSTREET]
	, [INVOICEADDRESSSTREETNUMBER]
	, [INVOICEADDRESSZIPCODE]
	, [INVOICEADDRESSCITY]
	, [INVOICEADDRESSCOUNTRYREGIONID]
	, [SALESORDERRESPONSIBLEPERSONNELNUMBER]
	, [SALESORDERORIGINCODE]
	, [LEDGERVOUCHER]
	, [PARTITION]
	, [DATAAREAID]
	, [SYNCSTARTDATETIME]
	, [RECID]
    FROM
(	SELECT
        [INVOICEHEADERTAXAMOUNT] 
	, [INVOICEADDRESSCOUNTRYREGIONISOCODE] 
	, [TOTALDISCOUNTAMOUNT] 
	, [DEFINITIONGROUP] 
	, [EXECUTIONID] 
	, [ISSELECTED] 
	, [TRANSFERSTATUS]
	, [INVOICENUMBER]
	, [INVOICEDATE] 
	, [CONTACTPERSONID] 
	, [CUSTOMERSORDERREFERENCE]
	, [DELIVERYMODECODE] 
	, [DELIVERYTERMSCODE]
	, [PAYMENTTERMSNAME]
	, [TOTALINVOICEAMOUNT]
	, [CURRENCYCODE]
	, [TOTALTAXAMOUNT]
	, [TOTALCHARGEAMOUNT]
	, [TOTALDISCOUNTCUSTOMERGROUPCODE]
	, [INVOICECUSTOMERACCOUNTNUMBER]
	, [SALESORDERNUMBER]
	, [INVOICEADDRESSSTATE]
	, [INVOICEADDRESSSTREET]
	, [INVOICEADDRESSSTREETNUMBER]
	, [INVOICEADDRESSZIPCODE]
	, [INVOICEADDRESSCITY]
	, [INVOICEADDRESSCOUNTRYREGIONID]
	, [SALESORDERRESPONSIBLEPERSONNELNUMBER]
	, [SALESORDERORIGINCODE]
	, [LEDGERVOUCHER]
	, [PARTITION]
	, [DATAAREAID]
	, [SYNCSTARTDATETIME]
	, [RECID]
	, ROW_NUMBER() OVER (PARTITION BY "INVOICENUMBER" ORDER BY "RECID") AS RowNumber ---Remove duplicate by INVOICENUMBER COLUMN
    FROM [dbo].[SalesInvoiceHeaderV2Staging] ) a
WHERE a.RowNumber = 1
